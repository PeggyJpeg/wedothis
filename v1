<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IIPR Investment Decision Dashboard | Premium Analysis</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Plotly -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    
    <style>
      :root {
        --primary-color: #2d6a4f;
        --primary-light: #40916c;
        --primary-dark: #1b4332;
        --secondary-color: #74c69d;
        --secondary-light: #b7e4c7;
        --accent-color: #d8f3dc;
        --text-dark: #212529;
        --text-medium: #495057;
        --text-light: #6c757d;
        --bg-light: #f8f9fa;
        --bg-white: #ffffff;
        --success-color: #198754;
        --danger-color: #dc3545;
        --warning-color: #ffc107;
        --info-color: #0dcaf0;
        --border-color: #dee2e6;
        --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
        --box-shadow-hover: 0 10px 15px rgba(0, 0, 0, 0.07), 0 4px 6px rgba(0, 0, 0, 0.12);
        --transition: all 0.3s ease;
      }

      /* Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f4f7f6;
        color: var(--text-dark);
        line-height: 1.6;
      }

      /* Container */
      .container {
        max-width: 1200px;
        margin: 40px auto;
        background-color: var(--bg-white);
        border-radius: 12px;
        box-shadow: var(--box-shadow);
        overflow: hidden;
      }

      /* Header */
      .header-container {
        background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-dark) 100%);
        color: white;
        padding: 40px 50px;
        text-align: center;
        position: relative;
      }

      .header-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect x="0" y="0" width="100" height="100" fill="none" stroke="%23ffffff" stroke-width="2" stroke-opacity="0.1"/></svg>');
        background-size: 20px 20px;
        opacity: 0.1;
      }

      .header-content {
        position: relative;
        z-index: 1;
      }

      .logo-container {
        margin-bottom: 25px;
        display: flex;
        justify-content: center;
      }

      .logo {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        object-fit: contain;
        background-color: white;
        padding: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      #logoFallback {
        width: 90px;
        height: 90px;
        background-color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        font-weight: bold;
        color: var(--primary-color);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .header-container h1 {
        font-family: 'Poppins', sans-serif;
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 600;
      }

      .header-container p {
        font-size: 1.2rem;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
      }

      .data-date {
        position: absolute;
        top: 20px;
        right: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        padding: 5px 10px;
        border-radius: 30px;
        font-size: 0.85rem;
      }

      /* Main Content */
      .main-content {
        padding: 40px 50px;
      }

      /* Section Styling */
      .section {
        margin-bottom: 50px;
        transition: var(--transition);
      }

      .section:last-child {
        margin-bottom: 20px;
      }

      .section-header {
        display: flex;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border-color);
      }

      .section-header i {
        font-size: 1.6rem;
        color: var(--primary-color);
        margin-right: 15px;
      }

      .section h2 {
        font-family: 'Poppins', sans-serif;
        color: var(--primary-dark);
        font-size: 1.7rem;
        font-weight: 600;
        flex: 1;
      }

      .section h2 small {
        font-weight: 400;
        font-size: 0.7em;
        color: var(--text-light);
        margin-left: 10px;
      }

      /* Data Grids */
      .data-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin-bottom: 25px;
      }

      .data-grid.grid-3 {
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      }

      .data-grid.grid-2 {
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      }

      .metric, .data-point {
        background-color: var(--bg-light);
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
      }

      .metric:hover, .data-point:hover {
        box-shadow: var(--box-shadow-hover);
        transform: translateY(-2px);
      }

      .metric::before, .data-point::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background-color: var(--secondary-color);
      }

      .metric strong, .data-point strong {
        color: var(--text-medium);
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
      }

      .metric strong i, .data-point strong i {
        margin-right: 8px;
        color: var(--primary-color);
      }

      .metric span, .data-point span {
        color: var(--text-dark);
        font-size: 1.2rem;
        font-weight: 500;
      }

      .metric span.value-emphasis, .data-point span.value-emphasis {
        font-weight: 700;
        color: var(--primary-color);
        font-size: 1.3rem;
      }

      /* Chart Container */
      .chart-container {
        background-color: var(--bg-light);
        border-radius: 8px;
        padding: 20px;
        margin-top: 25px;
        position: relative;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
      }

      #priceChart, #valuationChart {
        width: 100%;
        height: 400px;
      }

      /* List Styling */
      .info-list {
        list-style: none;
        margin-bottom: 20px;
      }

      .info-list li {
        background-color: var(--bg-light);
        padding: 15px 20px;
        margin-bottom: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        transition: var(--transition);
        position: relative;
        padding-left: 38px;
      }

      .info-list li:hover {
        box-shadow: var(--box-shadow-hover);
        transform: translateY(-2px);
      }

      .info-list li i {
        position: absolute;
        left: 12px;
        top: 16px;
        color: var(--primary-color);
      }

      .info-list li.positive {
        border-left: 4px solid var(--success-color);
      }

      .info-list li.negative {
        border-left: 4px solid var(--danger-color);
      }

      .info-list li.neutral {
        border-left: 4px solid var(--secondary-color);
      }

      .info-list li.warning {
        border-left: 4px solid var(--warning-color);
      }

      .info-list li.info {
        border-left: 4px solid var(--info-color);
      }

      .info-list li strong {
        display: block;
        margin-bottom: 5px;
        color: var(--text-dark);
      }

      /* Description Section */
      .description-box {
        background-color: var(--bg-light);
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        position: relative;
        overflow: hidden;
      }

      .description-box::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background-color: var(--secondary-color);
      }

      /* Investment Thesis */
      .thesis-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 25px;
      }

      .thesis-card {
        background-color: var(--bg-light);
        border-radius: 8px;
        padding: 25px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        transition: var(--transition);
      }

      .thesis-card:hover {
        box-shadow: var(--box-shadow-hover);
        transform: translateY(-2px);
      }

      .thesis-card h3 {
        font-family: 'Poppins', sans-serif;
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        font-size: 1.2rem;
        color: var(--text-dark);
      }

      .thesis-card h3 i {
        margin-right: 10px;
      }

      .thesis-card.positive {
        border-left: 4px solid var(--success-color);
      }

      .thesis-card.positive h3 i {
        color: var(--success-color);
      }

      .thesis-card.negative {
        border-left: 4px solid var(--danger-color);
      }

      .thesis-card.negative h3 i {
        color: var(--danger-color);
      }

      .thesis-card ul {
        list-style: none;
        margin-left: 5px;
      }

      .thesis-card ul li {
        margin-bottom: 8px;
        position: relative;
        padding-left: 20px;
      }

      .thesis-card ul li::before {
        content: '•';
        position: absolute;
        left: 0;
        color: inherit;
      }

      /* Credit Profile Section */
      .credit-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .credit-metric {
        background-color: var(--bg-light);
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
      }

      .credit-metric .value {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .credit-metric .label {
        font-size: 0.9rem;
        color: var(--text-medium);
      }

      .credit-metric.good .value {
        color: var(--success-color);
      }

      .credit-metric.caution .value {
        color: var(--warning-color);
      }

      .credit-metric.warning .value {
        color: var(--danger-color);
      }

      /* Football Field Valuation */
      .football-field {
        margin-top: 30px;
      }

      .valuation-methods {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-weight: 500;
        color: var(--text-medium);
      }

      .football-field-container {
        height: 120px;
        background-color: #f0f0f0;
        border-radius: 4px;
        position: relative;
        margin-bottom: 30px;
        overflow: hidden;
      }

      .valuation-range {
        position: absolute;
        height: 100%;
        background-color: var(--primary-light);
        opacity: 0.7;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      .current-price-marker {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: var(--danger-color);
      }

      .current-price-label {
        position: absolute;
        top: -25px;
        transform: translateX(-50%);
        background-color: var(--danger-color);
        color: white;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .valuation-notes {
        font-size: 0.9rem;
        color: var(--text-light);
        margin-top: 10px;
      }

      /* Analyst Coverage */
      .analyst-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      .analyst-table th, .analyst-table td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
      }

      .analyst-table th {
        background-color: var(--bg-light);
        font-weight: 600;
        color: var(--primary-dark);
      }

      .analyst-table tr:hover {
        background-color: rgba(0, 0, 0, 0.02);
      }

      .rating-buy {
        color: var(--success-color);
        font-weight: 600;
      }

      .rating-hold {
        color: var(--warning-color);
        font-weight: 600;
      }

      .rating-sell {
        color: var(--danger-color);
        font-weight: 600;
      }

      /* Footer */
      footer {
        background-color: var(--bg-light);
        text-align: center;
        padding: 30px 50px;
        border-top: 1px solid var(--border-color);
        font-size: 0.9rem;
        color: var(--text-light);
      }

      footer a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
      }

      footer a:hover {
        text-decoration: underline;
      }

      /* Loading Animation */
      .loading {
        position: relative;
        min-height: 24px;
        color: transparent;
      }

      .loading::after {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, var(--bg-light), var(--border-color), var(--bg-light));
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
        border-radius: 4px;
      }

      @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }

      /* Error States */
      .error-message {
        padding: 15px;
        background-color: #fff8f8;
        border-left: 4px solid var(--danger-color);
        margin: 10px 0;
        color: var(--danger-color);
        border-radius: 4px;
      }

      /* Responsive Adjustments */
      @media (max-width: 1200px) {
        .container {
          margin: 30px 20px;
        }
      }

      @media (max-width: 992px) {
        .container {
          margin: 20px;
        }
        .main-content, .header-container {
          padding: 30px;
        }
        .thesis-grid {
          grid-template-columns: 1fr;
        }
        .credit-metrics {
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
      }

      @media (max-width: 768px) {
        .header-container h1 {
          font-size: 2rem;
        }
        .section h2 {
          font-size: 1.5rem;
        }
        .data-grid {
          grid-template-columns: 1fr;
        }
        .data-date {
          position: static;
          margin: 15px auto 0;
          display: inline-block;
        }
        .analyst-table {
          display: block;
          overflow-x: auto;
        }
      }

      @media (max-width: 576px) {
        .container {
          margin: 10px;
        }
        .main-content, .header-container {
          padding: 20px;
        }
        .header-container h1 {
          font-size: 1.8rem;
        }
        .credit-metrics {
          grid-template-columns: 1fr 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header Banner -->
      <div class="header-container">
        <div class="header-content">
          <div class="logo-container">
            <img
              id="companyLogo"
              src=""
              alt="Company Logo"
              class="logo"
              onerror="this.style.display='none'; document.getElementById('logoFallback').style.display='flex';"
            />
            <div id="logoFallback" style="display: none;">
              IIPR
            </div>
          </div>
          <h1 id="companyName">Loading...</h1>
          <p>Comprehensive Investment Decision Dashboard</p>
          <div class="data-date">
            <i class="fas fa-calendar-alt"></i> 
            Data as of <span id="dataDate">analyzing...</span>
          </div>
        </div>
      </div>

      <div class="main-content">
        <!-- Executive Summary -->
        <section class="section" id="executive-summary">
          <div class="section-header">
            <i class="fas fa-file-alt"></i>
            <h2>Executive Summary</h2>
          </div>
          
          <div class="description-box">
            <p id="description" class="loading">Loading company description...</p>
          </div>

          <div class="data-grid grid-3">
            <div class="data-point">
              <strong><i class="fas fa-tag"></i> Ticker</strong>
              <span id="ticker">IIPR (NYSE)</span>
            </div>
            <div class="data-point">
              <strong><i class="fas fa-industry"></i> Industry</strong>
              <span id="industry" class="loading">Loading...</span>
            </div>
            <div class="data-point">
              <strong><i class="fas fa-cannabis"></i> Specialization</strong>
              <span>Cannabis Industry Real Estate</span>
            </div>
            <div class="data-point">
              <strong><i class="fas fa-calendar-day"></i> Founded</strong>
              <span id="founded" class="loading">Loading...</span>
            </div>
            <div class="data-point">
              <strong><i class="fas fa-map-marker-alt"></i> Headquarters</strong>
              <span id="hq" class="loading">Loading...</span>
            </div>
            <div class="data-point">
              <strong><i class="fas fa-globe"></i> Website</strong>
              <span id="website" class="loading">Loading...</span>
            </div>
          </div>
        </section>

        <!-- Financial Health Section -->
        <section class="section" id="financials-section">
          <div class="section-header">
            <i class="fas fa-chart-line"></i>
            <h2>Financial Health & Key Metrics</h2>
          </div>
          
          <div class="data-grid grid-3">
            <div class="metric">
              <strong><i class="fas fa-dollar-sign"></i> Market Cap</strong>
              <span id="marketCap" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-money-bill-wave"></i> Revenue (TTM)</strong>
              <span id="revenue" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-chart-pie"></i> P/E Ratio (TTM)</strong>
              <span id="peRatio" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-hand-holding-usd"></i> Dividend Yield</strong>
              <span id="dividendYield" class="loading value-emphasis">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-percentage"></i> Payout Ratio (TTM)</strong>
              <span id="payoutRatio" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-balance-scale"></i> Debt / Assets (TTM)</strong>
              <span id="debtToAssets" class="loading">Loading...</span>
            </div>
          </div>
          
          <p><i class="fas fa-info-circle"></i> Note: AFFO (Adjusted Funds From Operations) is the preferred metric for REITs instead of earnings, but requires specific calculation or premium data sources.</p>
        </section>

        <!-- Stock Performance Section -->
        <section class="section" id="performance-section">
          <div class="section-header">
            <i class="fas fa-chart-area"></i>
            <h2>Stock Performance & Valuation</h2>
          </div>

          <div class="data-grid grid-3">
            <div class="metric">
              <strong><i class="fas fa-money-bill"></i> Current Stock Price</strong>
              <span id="currentPrice" class="loading value-emphasis">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-exchange-alt"></i> Day's Change</strong>
              <span id="dayChange" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-arrows-alt-v"></i> 52-Week Range</strong>
              <span id="52WeekRange" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-book"></i> Price / Book (TTM)</strong>
              <span id="pbRatio" class="loading">Loading...</span>
            </div>
            <div class="metric">
              <strong><i class="fas fa-chart-bar"></i> Average Volume</strong>
              <span id="avgVolume" class="loading">Loading...</span>
            </div>
            <div class="metric" id="betaContainer">
              <strong><i class="fas fa-tachometer-alt"></i> Beta (Volatility)</strong>
              <span id="beta" class="loading">Loading...</span>
            </div>
          </div>

          <div class="chart-container">
            <div id="priceChart">
              <div class="placeholder-text">Loading Price Chart...</div>
            </div>
          </div>
        </section>

        <!-- Football Field Valuation -->
        <section class="section" id="valuation-section">
          <div class="section-header">
            <i class="fas fa-football-ball"></i>
            <h2>Football Field Valuation</h2>
          </div>

          <div class="football-field">
            <div class="valuation-methods">
              <span>P/E Multiple</span>
              <span>P/AFFO Multiple</span>
              <span>DCF Analysis</span>
              <span>NAV Approach</span>
            </div>
            
            <div class="football-field-container" id="footballField">
              <div class="valuation-range" style="left: 25%; width: 25%;">
                $90 - $110
              </div>
              <div class="valuation-range" style="left: 50%; width: 25%;">
                $100 - $120
              </div>
              <div class="valuation-range" style="left: 75%; width: 25%;">
                $95 - $115
              </div>
              <div class="current-price-marker" id="currentPriceMarker" style="left: 60%;"></div>
